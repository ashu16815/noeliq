# NoelIQ Backend Environment Variables Template
# Copy this file to .env in the backend/ directory and fill in your values
# Command: cp env.template .env

# ============================================
# Azure OpenAI Configuration
# ============================================
# Get these from: Azure Portal → Your Azure OpenAI Resource → Keys and Endpoint
AZURE_OPENAI_ENDPOINT=https://your-resource.openai.azure.com/
AZURE_OPENAI_API_KEY=your-api-key-here
AZURE_OPENAI_DEPLOYMENT_NAME=gpt-4o
AZURE_OPENAI_EMBEDDING_DEPLOYMENT_NAME=text-embedding-3-large

# ============================================
# Azure AI Search Configuration
# ============================================
# Get these from: Azure Portal → Your Azure AI Search Resource → Keys
AZURE_SEARCH_ENDPOINT=https://your-search-service.search.windows.net
AZURE_SEARCH_API_KEY=your-search-api-key-here
AZURE_SEARCH_INDEX_NAME=noeliq-products

# ============================================
# Data Storage
# ============================================
# Using JSON file storage in backend/data/ directory
# No database configuration needed

# ============================================
# Server Configuration
# ============================================
PORT=5000
NODE_ENV=development

# Frontend URL for CORS (set in Vercel for production)
# Example: https://frontend-xxx.vercel.app
FRONTEND_URL=

# ============================================
# Authentication Tokens (MVP: Simple Tokens)
# ============================================
# Generate secure random tokens for production
# Example: openssl rand -hex 32
ADMIN_TOKEN=your-secure-admin-token-here
STAFF_TOKEN=your-secure-staff-token-here

# ============================================
# RAG (Retrieval-Augmented Generation) Configuration
# ============================================
# Number of product chunks to retrieve for each query
# More chunks = more context but higher token usage
# Recommended: 3-10 depending on token limits
# Default: 5
RAG_CHUNK_LIMIT=5

# Enable optimized RAG retrieval (hybrid search, reranking, summarization)
# Set to 'true' to use advanced retrieval with:
# - Hybrid vector + keyword search
# - Score threshold filtering
# - Reranking and deduplication
# - Context summarization for large contexts
# Default: false (uses simple vector search)
USE_OPTIMIZED_RAG=false

# ============================================
# Turn Orchestrator Configuration
# ============================================
# Enable the new turn orchestrator pipeline (recommended for production)
# Set to 'true' to use advanced conversational context management:
# - Intent classification
# - Entity resolution
# - Query rewriting with context
# - Context condensation
# - Enhanced retrieval with filters
# - Review enrichment
# Default: false (uses legacy flow)
USE_TURN_ORCHESTRATOR=false

# ============================================
# Optional: Turn Orchestrator Advanced Configuration
# ============================================
# These are optional - defaults are sensible for most use cases
# Uncomment and adjust only if you need fine-tuning

# Azure Search retrieval settings
# AZURE_SEARCH_TOP=24
# MAX_CHUNKS_AFTER_DIVERSIFY=10
# MIN_CHUNK_SCORE=0.55
# K_SEMANTIC=12
# K_LEXICAL=12

# Summarization settings
# USE_SUMMARIZATION=true
# SUMMARIZATION_MODEL=gpt-4o-mini
# SUMMARIZATION_MAX_TOKENS=900

# Main LLM settings
# MAIN_LLM_MODEL=gpt-4o
# MAIN_LLM_TEMPERATURE=0.3

# Intent classifier settings
# INTENT_CLASSIFIER_USE_LLM=true
# INTENT_CLASSIFIER_MODEL=gpt-4o-mini
# INTENT_CLASSIFIER_TEMPERATURE=0.1

# Query rewriter settings
# QUERY_REWRITER_MODEL=gpt-4o-mini
# QUERY_REWRITER_TEMPERATURE=0.3
# QUERY_REWRITER_MAX_TOKENS=500

# ============================================
# Web Review & Comparison (Optional)
# ============================================
# Enable web review enrichment (requires Azure Bing Search API)
# Set to 'true' to fetch and summarize customer reviews from the web
# Default: false
USE_WEB_REVIEWS=false

# Azure Bing Search API Configuration
# Get these from: Azure Portal → Create Resource → Bing Search v7
# WEB_SEARCH_ENDPOINT=https://api.bing.microsoft.com/v7.0/search
# WEB_SEARCH_API_KEY=your-bing-search-api-key-here
# WEB_SEARCH_REGION=en-NZ
# WEB_SEARCH_MAX_RESULTS=8
# WEB_SEARCH_RECENCY_DAYS=365

# Web review cache TTL (in days)
# How long to cache web review results before refetching
# Default: 7 days
# WEB_REVIEW_CACHE_TTL_DAYS=7

